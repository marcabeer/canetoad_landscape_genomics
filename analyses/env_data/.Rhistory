View(env_mean)
#calculate correlations
global_corr_prefilter = round(cor(env_mean[,c("bio2", "bio4", "bio12", "elev", "bio1", "bio3", "bio7", "bio15", "year")]),2)
global_corr <- round(cor(env_filtered[,c("bio2", "bio4", "bio12", "elev", "year")]),2)
nw_corr <- round(cor(env_filtered[which(md_sites$region_name=="NW"),c("bio2", "bio4", "bio12", "elev", "year")]),2)
#remove environmental factors that correlate with colonization year at |r| > 0.70 across all localities
##retains only bio2, bio4, bio7, bio12, and elev
env_v2<-subset(env_mean, select=c(pop, region, bio2, bio4, bio7, bio12, elev, year))
corrplot(cor(env_v2[,-c(1,2)]), method="color", col=col(200), type="upper", addgrid.col="gray70", addCoef.col="gray10", tl.cex=1, tl.col="black", number.cex=0.9, diag=TRUE)
#now remove environmental factors that correlate with one another at |r| > 0.70 across all localities
#bio7 is strongly correlated with many other variables, so remove it
##end up with three variables: bio2, bio4, bio12, and elev (plus colonization year)
env_v3<-subset(env_v2, select=-c(bio7))
corrplot(cor(env_v3[,-c(1,2)]), method="color", col=col(200), type="upper", addgrid.col="gray70", addCoef.col="gray10", tl.cex=1, tl.col="black", number.cex=0.9, diag=TRUE)
#export filtered set of environmental variables
env_filtered<-data.frame(pop=env_v3$pop, long=md_sites$long, lat=md_sites$lat, env_v3[,-c(1,2)])
View(env_filtered)
#calculate correlations
global_corr_prefilter = round(cor(env_mean[,c("bio2", "bio4", "bio12", "elev", "bio1", "bio3", "bio7", "bio15", "year")]),2)
global_corr <- round(cor(env_filtered[,c("bio2", "bio4", "bio12", "elev", "year")]),2)
nw_corr <- round(cor(env_filtered[which(md_sites$region_name=="NW"),c("bio2", "bio4", "bio12", "elev", "year")]),2)
ne_corr <- round(cor(env_filtered[which(md_sites$region_name=="NE"),c("bio2", "bio4", "bio12", "elev", "year")]), 2)
s_corr <- round(cor(env_filtered[which(md_sites$region_name=="S"),c("bio2", "bio4", "bio12", "elev", "year")]), 2)
#rename variables with full names
colnames(global_corr_prefilter) <- c("Mean temperature\ndiurnal range", "Temperature\nseasonality", "Annual\nprecipitation", "Elevation",
"Mean annual\ntemperature", "Isothermality", "Temperature\nannual range", "Precipitation\nseasonality", "Colonization\nyear")
rownames(global_corr_prefilter) <- c("Mean temperature\ndiurnal range", "Temperature\nseasonality", "Annual\nprecipitation", "Elevation",
"Mean annual\ntemperature", "Isothermality", "Temperature\nannual range", "Precipitation\nseasonality", "Colonization\nyear")
colnames(global_corr) <- c("Mean temperature\ndiurnal range", "Temperature\nseasonality", "Annual\nprecipitation", "Elevation", "Colonization\nyear")
rownames(global_corr) <- c("Mean temperature\ndiurnal range", "Temperature\nseasonality", "Annual\nprecipitation", "Elevation", "Colonization\nyear")
colnames(nw_corr) <- c("Mean temperature\ndiurnal range", "Temperature\nseasonality", "Annual\nprecipitation", "Elevation", "Colonization\nyear")
rownames(nw_corr) <- c("Mean temperature\ndiurnal range", "Temperature\nseasonality", "Annual\nprecipitation", "Elevation", "Colonization\nyear")
colnames(ne_corr) <- c("Mean temperature\ndiurnal range", "Temperature\nseasonality", "Annual\nprecipitation", "Elevation", "Colonization\nyear")
rownames(ne_corr) <- c("Mean temperature\ndiurnal range", "Temperature\nseasonality", "Annual\nprecipitation", "Elevation", "Colonization\nyear")
colnames(s_corr) <- c("Mean temperature\ndiurnal range", "Temperature\nseasonality", "Annual\nprecipitation", "Elevation", "Colonization\nyear")
rownames(s_corr) <- c("Mean temperature\ndiurnal range", "Temperature\nseasonality", "Annual\nprecipitation", "Elevation", "Colonization\nyear")
#make correlation plots
plot_marg <- 5
corrplot_global <- ggcorrplot(global_corr, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_global_prefilter <- ggcorrplot(global_corr_prefilter, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_global <- ggcorrplot(global_corr, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_nw <- ggcorrplot(nw_corr, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_ne <- ggcorrplot(ne_corr, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_s <- ggcorrplot(s_corr, method="square", lab=TRUE)+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_global_prefilter / (corrplot_global | corrplot_nw) / (corrplot_ne | corrplot_s) + plot_annotation(tag_levels="A") & theme(plot.tag = element_text(size = 25))
(corrplot_global | corrplot_nw) / (corrplot_ne | corrplot_s) + plot_annotation(tag_levels="A") & theme(plot.tag = element_text(size = 25))
corrplot_global_prefilter + corrplot_global + corrplot_nw + corrplot_ne + corrplot_s + plot_annotation(tag_levels="A") + plot_layout(design=layout, guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
layout <- "
AAABBB
AAABBB
AAABBB
CCDDEE
CCDDEE
"
corrplot_global_prefilter + corrplot_global + corrplot_nw + corrplot_ne + corrplot_s + plot_annotation(tag_levels="A") + plot_layout(design=layout, guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=16, height=12)
layout <- "
AAABBBCCC
AAABBBCCC
AAABBBCCC
DDDEEEFFF
DDDEEEFFF
DDDEEEFFF
"
corrplot_global_prefilter + plot_spacer() + corrplot_global + corrplot_nw + corrplot_ne + corrplot_s + plot_annotation(tag_levels="A") + plot_layout(design=layout, guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
corrplot_global_prefilter + corrplot_global + plot_spacer() + corrplot_nw + corrplot_ne + corrplot_s + plot_annotation(tag_levels="A") + plot_layout(design=layout, guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=16, height=12)
layout <- "
AAABBB
AAABBB
AAABBB
CCCDDD
CCCDDD
CCCDDD
EEEFFF
EEEFFF
EEEFFF
"
corrplot_global_prefilter + corrplot_global + corrplot_nw + corrplot_ne + corrplot_s + plot_spacer() + plot_annotation(tag_levels="A") + plot_layout(design=layout, guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=16, height=12)
ggsave("corrplot_filtered.png", width=12, height=16)
ggsave("corrplot_filtered.png", width=14, height=16)
#make correlation plots
plot_marg <- 2
corrplot_global_prefilter <- ggcorrplot(global_corr_prefilter, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_global <- ggcorrplot(global_corr, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_nw <- ggcorrplot(nw_corr, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_ne <- ggcorrplot(ne_corr, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_s <- ggcorrplot(s_corr, method="square", lab=TRUE)+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
(corrplot_global | corrplot_nw) / (corrplot_ne | corrplot_s) + plot_annotation(tag_levels="A") & theme(plot.tag = element_text(size = 25))
layout <- "
AAABBB
AAABBB
AAABBB
CCCDDD
CCCDDD
CCCDDD
EEEFFF
EEEFFF
EEEFFF
"
corrplot_global_prefilter + corrplot_global + corrplot_nw + corrplot_ne + corrplot_s + plot_spacer() + plot_annotation(tag_levels="A") + plot_layout(design=layout, guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=14, height=16)
layout <- "
AABBBBCC
AABBBBCC
AABBBBCC
AABBBBCC
DDDDEEEE
DDDDEEEE
DDDDEEEE
DDDDEEEE
FFFFGGGG
FFFFGGGG
FFFFGGGG
FFFFGGGG
"
plot_spacer() + corrplot_global_prefilter + plot_spacer() + corrplot_global + corrplot_nw + corrplot_ne + corrplot_s + plot_annotation(tag_levels="A") + plot_layout(design=layout, guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=14, height=16)
layout <- "
AABBBBCC
AABBBBCC
AABBBBCC
AABBBBCC
DDDEEFFF
DDDEEFFF
DDDEEFFF
GGGHHIII
GGGHHIII
GGGHHIII
"
plot_spacer() + corrplot_global_prefilter + plot_spacer() + corrplot_global + plot_spacer() + corrplot_nw + corrplot_ne + plot_spacer() + corrplot_s + plot_annotation(tag_levels="A") + plot_layout(design=layout, guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=14, height=16)
ggsave("corrplot_filtered.png", width=12, height=16)
plot_spacer() + corrplot_global_prefilter + plot_spacer() + corrplot_global + plot_spacer() + corrplot_nw + corrplot_ne + plot_spacer() + corrplot_s + plot_annotation(tag_levels="A") + plot_layout(heights=c(2,1,1), guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
corrplot_global_prefilter + corrplot_global + corrplot_nw + corrplot_ne + corrplot_s + plot_annotation(tag_levels="A") + plot_layout(heights=c(2,1,1), guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
corrplot_global_prefilter / corrplot_global + corrplot_nw / corrplot_ne + corrplot_s + plot_annotation(tag_levels="A") + plot_layout(heights=c(2,1,1), guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
corrplot_global_prefilter / (corrplot_global + corrplot_nw) / (corrplot_ne + corrplot_s) + plot_annotation(tag_levels="A") + plot_layout(heights=c(2,1,1), guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=12, height=16)
#make correlation plots
plot_marg <- 5
corrplot_global_prefilter <- ggcorrplot(global_corr_prefilter, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_global <- ggcorrplot(global_corr, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_nw <- ggcorrplot(nw_corr, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_ne <- ggcorrplot(ne_corr, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_s <- ggcorrplot(s_corr, method="square", lab=TRUE)+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_global_prefilter / (corrplot_global + corrplot_nw) / (corrplot_ne + corrplot_s) + plot_annotation(tag_levels="A") + plot_layout(heights=c(2,1,1), guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=12, height=16)
(corrplot_global_prefilter + plot_spacer()) / (corrplot_global + corrplot_nw) / (corrplot_ne + corrplot_s) + plot_annotation(tag_levels="A") + plot_layout(heights=c(2,1,1), guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=12, height=16)
corrplot_global_prefilter / (corrplot_global + corrplot_nw) / (corrplot_ne + corrplot_s) + plot_annotation(tag_levels="A") + plot_layout(heights=c(2,1,1), guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=12, height=16)
#make correlation plots
plot_marg <- 5
plot_marg_right = 10
corrplot_global_prefilter <- ggcorrplot(global_corr_prefilter, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg_right, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_global <- ggcorrplot(global_corr, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg_right, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_nw <- ggcorrplot(nw_corr, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg_right, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_ne <- ggcorrplot(ne_corr, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg_right, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_s <- ggcorrplot(s_corr, method="square", lab=TRUE)+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg_right, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
plot_spacer() + corrplot_global_prefilter + plot_spacer() + corrplot_global + plot_spacer() + corrplot_nw + corrplot_ne + plot_spacer() + corrplot_s + plot_annotation(tag_levels="A") + plot_layout(design=layout, guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
corrplot_global_prefilter / (corrplot_global + corrplot_nw) / (corrplot_ne + corrplot_s) + plot_annotation(tag_levels="A") + plot_layout(heights=c(2,1,1), guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=12, height=16)
corrplot_global_prefilter / (corrplot_global + corrplot_nw) / (corrplot_ne + corrplot_s) + plot_annotation(tag_levels="A") + plot_layout(heights=c(3,1,1), guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=12, height=16)
corrplot_global_prefilter / (corrplot_global + corrplot_nw) / (corrplot_ne + corrplot_s) + plot_annotation(tag_levels="A") + plot_layout(heights=c(3,1,1), guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=12, height=18)
corrplot_global_prefilter / (corrplot_global + corrplot_nw) / (corrplot_ne + corrplot_s) + plot_annotation(tag_levels="A") + plot_layout(heights=c(2.5,1,1), guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=12, height=16)
4/1.5
corrplot_global_prefilter / (corrplot_global + corrplot_nw) / (corrplot_ne + corrplot_s) + plot_annotation(tag_levels="A") + plot_layout(heights=c(4,1.5,1.5), guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=12, height=16)
corrplot_global_prefilter / (corrplot_global + corrplot_nw) / (corrplot_ne + corrplot_s) + plot_annotation(tag_levels="A") + plot_layout(heights=c(2,1,1), guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=12, height=16)
ggsave("corrplot_filtered.png", width=18, height=24)
16*1.25
12*1.25
ggsave("corrplot_filtered.png", width=15, height=20)
#plot including all starting environmental factors
corrplot_global_prefilter / (corrplot_global + corrplot_nw) / (corrplot_ne + corrplot_s) + plot_annotation(tag_levels="A") + plot_layout(heights=c(2,1,1), guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=15, height=20)
ggsave("corrplot_filtered.png", width=15, height=20)
#plot including all starting environmental factors
corrplot_global_prefilter / (corrplot_global + corrplot_nw) / (corrplot_ne + corrplot_s) + plot_annotation(tag_levels="A") + plot_layout(heights=c(2,1,1), guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=15, height=20)
ggsave("corrplot_filtered.svg", width=15, height=20)
?ggcorrplot
corrplot_global_prefilter <- ggcorrplot(global_corr_prefilter, method="square", lab=TRUE)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg_right, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_global_prefilter
corrplot_global_prefilter <- ggcorrplot(global_corr_prefilter, method="square", lab=TRUE, lab_size=10)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg_right, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_global_prefilter
corrplot_global_prefilter <- ggcorrplot(global_corr_prefilter, method="square", lab=TRUE, lab_size=1)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg_right, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_global_prefilter
corrplot_global_prefilter <- ggcorrplot(global_corr_prefilter, method="square", lab=TRUE, lab_size=4)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg_right, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_global_prefilter
corrplot_global_prefilter <- ggcorrplot(global_corr_prefilter, method="square", lab=TRUE, lab_size=5)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg_right, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_global_prefilter
corrplot_global_prefilter <- ggcorrplot(global_corr_prefilter, method="square", lab=TRUE, lab_size=5)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg_right, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_global_prefilter
corrplot_global <- ggcorrplot(global_corr, method="square", lab=TRUE, lab_size=5)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg_right, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_nw <- ggcorrplot(nw_corr, method="square", lab=TRUE, lab_size=5)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg_right, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_ne <- ggcorrplot(ne_corr, method="square", lab=TRUE, lab_size=5)+
labs(x="", y="")+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg_right, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
corrplot_s <- ggcorrplot(s_corr, method="square", lab=TRUE, lab_size=5)+
theme_minimal()+
theme(axis.title.x = element_text(size=18, margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.title.y = element_text(size=18, margin = margin(t = 0, r = 10, b = 0, l = 0)))+
theme(axis.text.x = element_text(size=14, angle=90, vjust=0.5), axis.text.y = element_text(size=14))+
theme(legend.title = element_text(size=16), legend.text = element_text(size=14))+
theme(plot.margin = margin(t = plot_marg, r = plot_marg_right, b = plot_marg, l = plot_marg))+
scale_fill_gradient2(low = "royalblue2", mid="white", high = "firebrick3", breaks=c(-1, 0, 1), limit=c(-1, 1))+
labs(x="", y="", fill="Pearson's\nr")+
theme(legend.position=c(-0.2, -0.25), legend.key.height=unit(0.33, "cm"))
#plot including all starting environmental factors
corrplot_global_prefilter / (corrplot_global + corrplot_nw) / (corrplot_ne + corrplot_s) + plot_annotation(tag_levels="A") + plot_layout(heights=c(2,1,1), guides="collect") & theme(plot.tag = element_text(size = 25), legend.position="right")
ggsave("corrplot_filtered.png", width=15, height=20)
ggsave("corrplot_filtered.svg", width=15, height=20)
